# Author: Justin Yoo
# This script will automatically download TMY3 data files from the listed
# NREL website from station_list.  station_list is a list of WMO weather 
# station numbers.  There are 1020 WMO weather stations located across the 
# world that provide TMY3 data.  This script can be modified to accept
# station_list from another data source.  The TMY3 data files will be
# downloaded to the same folder as this script.
#
# As of 3/1/21, this script is deprecated, as NREL NSRDB has an API to request
# TMY3 data.  More info here https://nsrdb.nrel.gov/about/tmy.html 
# Script will be updated when more TMY3 data is required.

from urllib import request

station_list = (722010, 722020, 722045, 722050, 722056, 722060, 722070, 722080, 722106, 722110, 722140, 722146, 722170, 722180, 722190, 722223, 722230, 722255, 722260, 722280, 722310, 722340, 722350, 722400, 722410, 722430, 722446, 722480, 722500, 722510, 722530, 722540, 722550, 722560, 722590, 722630, 722650, 722660, 722670, 722680, 722700, 722740, 722780, 722900, 722950, 722970, 723013, 723040, 723060, 723080, 723100, 723110, 723120, 723140, 723150, 723170, 723183, 723230, 723240, 723260, 723270, 723340, 723403, 723627, 723650, 723723, 723815, 723840, 723860, 723870, 723890, 723925, 723940, 724010, 724030, 724050, 724060, 724070, 724080, 724089, 724100, 724110, 724120, 724140, 724170, 724210, 724220, 724230, 724236, 724250, 724280, 724290, 724320, 724340, 724345, 724350, 724380, 724390, 724400, 724450, 724460, 724585, 724665, 724755, 724760, 724830, 724855, 724860, 724880, 724940, 725020, 725030, 725035, 725040, 725070, 725080, 725090, 725095, 725115, 725130, 725140, 725150, 725170, 725180, 725190, 725200, 725210, 725240, 725246, 725250, 725260, 725266, 725280, 725290, 725300, 725320, 725330, 725350, 725360, 725370, 725375, 725390, 725430, 725440, 725460, 725470, 725480, 725485, 725500, 725560, 725570, 725620, 725640, 725650, 725660, 725670, 725690, 725720, 725744, 725760, 725780, 725805, 725830, 725920, 725945, 725970, 726050, 726060, 726088, 726170, 726223, 726350, 726360, 726370, 726380, 726387, 726390, 726400, 726410, 726430, 726435, 726440, 726450, 726510, 726540, 726550, 726580, 726590, 726620, 726660, 726686, 726770, 726810, 726880, 726930, 726940, 726980, 727120, 727340, 727450, 727470, 727530, 727640, 727670, 727676, 727680, 727720, 727730, 727750, 727790, 727810, 727830, 727850, 727920, 727930, 727970, 744860, 911650, 911820, 911900, 912850, 690150, 690190, 690230, 699604, 700260, 700637, 701043, 701195, 701330, 701718, 701740, 701780, 702000, 702005, 702084, 702185, 702186, 702190, 702310, 702460, 702495, 702510, 702590, 702600, 702606, 702607, 702610, 702647, 702650, 702670, 702710, 702720, 702730, 702735, 702740, 702750, 702756, 702757, 702770, 702910, 702960, 702986, 703080, 703160, 703165, 703210, 703260, 703330, 703400, 703410, 703430, 703500, 703606, 703610, 703620, 703670, 703710, 703810, 703855, 703860, 703870, 703950, 703980, 704140, 704890, 722015, 722016, 722024, 722025, 722026, 722029, 722030, 722039, 722040, 722053, 722055, 722057, 722065, 722066, 722068, 722085, 722103, 722104, 722108, 722115, 722116, 722119, 722135, 722136, 722137, 722160, 722166, 722175, 722195, 722196, 722210, 722215, 722225, 722226, 722235, 722245, 722250, 722265, 722267, 722268, 722269, 722270, 722286, 722287, 722314, 722315, 722316, 722317, 722329, 722345, 722348, 722356, 722357, 722358, 722359, 722390, 722405, 722406, 722420, 722429, 722435, 722436, 722445, 722448, 722470, 722485, 722486, 722487, 722505, 722506, 722515, 722516, 722517, 722520, 722524, 722526, 722535, 722536, 722555, 722570, 722575, 722576, 722577, 722583, 722588, 722594, 722595, 722596, 722597, 722598, 722599, 722610, 722615, 722636, 722656, 722686, 722687, 722695, 722710, 722725, 722735, 722745, 722784, 722785, 722789, 722800, 722860, 722868, 722869, 722880, 722885, 722886, 722897, 722903, 722904, 722906, 722926, 722927, 722930, 722956, 722976, 722977, 723030, 723035, 723046, 723066, 723067, 723068, 723069, 723075, 723085, 723086, 723090, 723095, 723096, 723106, 723119, 723125, 723145, 723193, 723235, 723265, 723306, 723307, 723320, 723346, 723347, 723405, 723406, 723407, 723415, 723416, 723417, 723418, 723419, 723440, 723445, 723446, 723489, 723495, 723510, 723520, 723525, 723527, 723530, 723535, 723540, 723544, 723545, 723546, 723550, 723560, 723565, 723566, 723575, 723600, 723604, 723630, 723656, 723658, 723676, 723677, 723700, 723740, 723747, 723783, 723805, 723810, 723816, 723820, 723865, 723896, 723910, 723927, 723965, 724016, 724035, 724037, 724040, 724045, 724066, 724075, 724085, 724086, 724088, 724094, 724095, 724096, 724105, 724106, 724125, 724127, 724175, 724176, 724177, 724235, 724240, 724243, 724273, 724275, 724286, 724288, 724297, 724335, 724336, 724338, 724339, 724373, 724375, 724386, 724396, 724397, 724455, 724456, 724457, 724458, 724459, 724463, 724467, 724468, 724475, 724490, 724500, 724505, 724506, 724507, 724510, 724515, 724516, 724517, 724518, 724555, 724556, 724560, 724565, 724580, 724586, 724620, 724625, 724635, 724640, 724645, 724650, 724655, 724660, 724666, 724673, 724675, 724676, 724677, 724695, 724698, 724723, 724735, 724754, 724756, 724765, 724767, 724768, 724769, 724795, 724800, 724815, 724837, 724838, 724839, 724885, 724915, 724917, 724920, 724926, 724927, 724930, 724935, 724936, 724945, 724955, 724957, 725025, 725036, 725037, 725038, 725045, 725046, 725054, 725058, 725060, 725063, 725065, 725066, 725067, 725073, 725086, 725087, 725088, 725098, 725103, 725116, 725117, 725118, 725125, 725126, 725127, 725128, 725145, 725156, 725165, 725185, 725197, 725205, 725235, 725245, 725267, 725287, 725305, 725314, 725315, 725316, 725326, 725335, 725336, 725340, 725347, 725366, 725374, 725376, 725377, 725395, 725396, 725450, 725455, 725465, 725473, 725490, 725510, 725520, 725524, 725525, 725526, 725533, 725540, 725555, 725556, 725565, 725610, 725625, 725626, 725635, 725636, 725645, 725700, 725705, 725715, 725724, 725745, 725750, 725755, 725765, 725775, 725776, 725785, 725786, 725810, 725825, 725845, 725846, 725847, 725865, 725866, 725867, 725868, 725895, 725905, 725910, 725946, 725955, 725958, 725975, 725976, 726055, 726064, 726073, 726077, 726079, 726116, 726130, 726145, 726155, 726165, 726184, 726185, 726227, 726228, 726355, 726357, 726375, 726379, 726385, 726404, 726416, 726455, 726456, 726457, 726458, 726463, 726465, 726468, 726480, 726487, 726499, 726500, 726515, 726525, 726545, 726546, 726555, 726556, 726557, 726559, 726560, 726563, 726564, 726565, 726566, 726567, 726575, 726576, 726579, 726583, 726584, 726585, 726586, 726587, 726588, 726589, 726625, 726650, 726665, 726676, 726685, 726700, 726776, 726785, 726797, 726798, 726815, 726830, 726835, 726884, 726886, 726904, 726917, 726945, 726985, 726986, 726988, 727033, 727130, 727344, 727347, 727415, 727437, 727440, 727445, 727453, 727455, 727457, 727458, 727459, 727473, 727475, 727477, 727535, 727550, 727555, 727573, 727575, 727576, 727645, 727675, 727686, 727687, 727770, 727796, 727815, 727825, 727826, 727827, 727834, 727840, 727845, 727846, 727855, 727856, 727857, 727910, 727923, 727924, 727926, 727928, 727934, 727935, 727937, 727938, 727976, 742060, 742070, 742300, 743700, 743920, 743945, 744655, 744864, 744865, 744904, 744910, 744915, 745160, 745700, 745940, 745980, 746120, 746710, 746716, 746930, 747020, 747185, 747187, 747188, 747320, 747685, 747686, 747750, 747770, 747804, 747810, 747880, 747900, 747910, 747915, 785140, 785145, 785203, 785260, 785430, 911760, 911780, 911860, 911904, 911905, 912120, 912180, 700197, 701625, 701940, 702035, 702040, 702070, 702075, 702225, 702320, 702595, 702725, 702746, 703407, 703884, 704540, 722038, 722284, 722285, 722404, 722484, 722499, 722523, 722533, 722544, 722547, 722563, 722587, 722640, 722683, 722689, 722747, 722748, 722895, 722899, 723065, 723083, 723143, 723200, 723300, 723434, 723443, 723444, 723447, 723448, 723449, 723526, 723663, 723710, 723755, 723830, 723895, 723926, 724014, 724017, 724026, 724033, 724036, 724053, 724055, 724056, 724058, 724084, 724107, 724113, 724115, 724116, 724117, 724238, 724354, 724365, 724454, 724504, 724509, 724550, 724636, 724699, 724776, 725029, 725033, 725064, 725075, 725124, 725378, 725384, 725453, 725454, 725456, 725457, 725463, 725464, 725467, 725468, 725469, 725474, 725475, 725476, 725477, 725478, 725479, 725483, 725484, 725486, 725487, 725488, 725489, 725493, 725494, 725495, 725496, 725497, 725515, 725527, 725530, 725564, 725566, 725628, 725717, 726083, 726115, 726160, 726196, 726384, 726395, 726415, 726464, 726467, 726498, 726544, 726547, 726558, 726568, 726569, 726574, 726578, 726603, 726626, 726813, 726865, 726959, 727135, 727444, 727452, 727474, 727476, 727478, 727503, 727504, 727505, 727507, 727533, 727556, 727566, 727885, 745090, 745966, 745985, 746943, 747540, 747946, 785263, 785350, 911975)

for i in station_list:
    url = 'http://rredc.nrel.gov/solar/old_data/nsrdb/1991-2005/data/tmy3/' + str(i) + 'TYA.CSV'
    csv = request.urlopen(url).read()
    with open (str(i)+'.csv', 'wb') as tmy3_weather_file:
        tmy3_weather_file.write(csv)
        print(str(i) + ' Download Complete')
